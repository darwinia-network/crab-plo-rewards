(self.webpackChunkcrab_plo_rewards=self.webpackChunkcrab_plo_rewards||[]).push([[845],{2966:function(e,t,n){"use strict";n.d(t,{JH:function(){return l},WA:function(){return u},Xg:function(){return i}});var r=n(2791),o=n(184),a=function(e){return(0,o.jsx)("div",{className:"container mx-auto h-screen relative pb-14 ".concat(e.className),children:e.children})},i=r.memo(a),s=function(e){return(0,o.jsx)("div",{className:"pt-10 page-content-height ".concat(e.className),children:e.children})},l=r.memo(s),u=function(){return(0,o.jsxs)("div",{className:"absolute top-auto bottom-0 h-20 w-full flex justify-center items-center space-x-3",children:[(0,o.jsx)("span",{children:"Copyright\xa92022"}),(0,o.jsx)("span",{children:"|"}),(0,o.jsx)("a",{href:"https://github.com/darwinia-network/crab-plo-rewards",target:"_blank",rel:"noopener noreferrer",children:"Github"}),(0,o.jsx)("span",{children:"|"}),(0,o.jsx)("a",{href:"https://crab.network/plo_contribute",target:"_blank",rel:"noopener noreferrer",children:"PLO"})]})}},9478:function(e,t,n){"use strict";n.d(t,{j9:function(){return u},bN:function(){return d},UM:function(){return c},cU:function(){return f},pD:function(){return h},x5:function(){return p}});var r,o,a=n(168),i=n(5395),s=n.n(i),l=n(7570),u=2e8,d=8e3,c=new(s())("1000000000000"),f=new(s())("7099040920573355"),h=(0,l.Ps)(r||(r=(0,a.Z)(["\n  query GetUsersContributePower($first: Int!, $offset: Int!) {\n    crowdloanWhoStatistics(orderBy: TOTAL_BALANCE_DESC, first: $first, offset: $offset) {\n      totalCount\n      pageInfo{\n        hasNextPage\n      }\n      nodes {\n        user\n        totalPower\n        contributors {\n          nodes {\n            powerRefer\n          }\n        }\n      }\n    }\n  }\n"]))),p=(0,l.Ps)(o||(o=(0,a.Z)(["\n  query GetUserNftClaimed($first: Int!, $offset: Int!) {\n    remarkedNftAddresses(orderBy: [EXTRINSIC_TIMESTAMP_ASC], first: $first, offset: $offset) {\n      totalCount\n      pageInfo {\n        hasNextPage\n      }\n      nodes {\n        signer\n        addressValue\n        extrinsicHash\n      }\n    }\n  }\n"])))},1641:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var r,o=n(2791),a=n(199),i=n(1358),s=n(8164),l=n(9388),u=n(5970),d=n(9592),c=n(9819),f=n(9484),h=n(8055),p=n(6260);!function(e){e[e.Query=0]="Query",e[e.Mutation=1]="Mutation",e[e.Subscription=2]="Subscription"}(r||(r={}));var v=new Map;function g(e){var t;switch(e){case r.Query:t="Query";break;case r.Mutation:t="Mutation";break;case r.Subscription:t="Subscription"}return t}function m(e,t){var n=function(e){var t,n,o=v.get(e);if(o)return o;__DEV__?(0,p.kG)(!!e&&!!e.kind,"Argument of ".concat(e," passed to parser was not a valid GraphQL ")+"DocumentNode. You may need to use 'graphql-tag' or another method to convert your operation into a document"):(0,p.kG)(!!e&&!!e.kind,30);var a=e.definitions.filter((function(e){return"FragmentDefinition"===e.kind})),i=e.definitions.filter((function(e){return"OperationDefinition"===e.kind&&"query"===e.operation})),s=e.definitions.filter((function(e){return"OperationDefinition"===e.kind&&"mutation"===e.operation})),l=e.definitions.filter((function(e){return"OperationDefinition"===e.kind&&"subscription"===e.operation}));__DEV__?(0,p.kG)(!a.length||i.length||s.length||l.length,"Passing only a fragment to 'graphql' is not yet supported. You must include a query, subscription or mutation as well"):(0,p.kG)(!a.length||i.length||s.length||l.length,31),__DEV__?(0,p.kG)(i.length+s.length+l.length<=1,"react-apollo only supports a query, subscription, or a mutation per HOC. "+"".concat(e," had ").concat(i.length," queries, ").concat(l.length," ")+"subscriptions and ".concat(s.length," mutations. ")+"You can use 'compose' to join multiple operation types to a component"):(0,p.kG)(i.length+s.length+l.length<=1,32),n=i.length?r.Query:r.Mutation,i.length||s.length||(n=r.Subscription);var u=i.length?i:s.length?s:l;__DEV__?(0,p.kG)(1===u.length,"react-apollo only supports one definition per HOC. ".concat(e," had ")+"".concat(u.length," definitions. ")+"You can use 'compose' to join multiple operation types to a component"):(0,p.kG)(1===u.length,33);var d=u[0];t=d.variableDefinitions||[];var c={name:d.name&&"Name"===d.name.kind?d.name.value:"data",type:n,variables:t};return v.set(e,c),c}(e),o=g(t),a=g(n.type);__DEV__?(0,p.kG)(n.type===t,"Running a ".concat(o," requires a graphql ")+"".concat(o,", but a ").concat(a," was used instead.")):(0,p.kG)(n.type===t,34)}var b=n(5046);function y(e,t,n){var r;void 0===t&&(t={});var o=t.skip,a=(t.ssr,t.onCompleted,t.onError,t.displayName,(0,l._T)(t,["skip","ssr","onCompleted","onError","displayName"])),i=(0,l.pi)({query:e},a);return n&&(i=(0,d.J)(n,i)),o?i.fetchPolicy="standby":(!(null===(r=i.context)||void 0===r?void 0:r.renderPromises)||"network-only"!==i.fetchPolicy&&"cache-and-network"!==i.fetchPolicy)&&i.fetchPolicy||(i.fetchPolicy="cache-first"),i.variables||(i.variables={}),i}var x=n(5485),w=n(1707),C=n(7253),k=n(184),R=[{title:"Index",dataIndex:"index",key:"index",align:"center"},{title:"Address",dataIndex:"address",key:"address",align:"center",render:function(e){return(0,k.jsx)(x.Z.Text,{copyable:{text:e},children:(0,C.sC)(e)})}},{title:"Current CRAB Rewards",dataIndex:"currentCRabRewards",key:"currentCRabRewards",align:"right"},{title:"Stage CRAB Rewards",dataIndex:"stageCRabRewards",key:"stageCRabRewards",align:"right"},{title:"Current CKTON Rewards",dataIndex:"currentCKtonRewards",key:"currentCKtonRewards",align:"right"},{title:"Stage CKTON Rewards",dataIndex:"stageCKtonRewards",key:"stageCKtonRewards",align:"right"}],S=function(e){var t=e.dataSource,n=e.loading;return(0,k.jsx)(w.Z,{columns:R,dataSource:t,loading:n,pagination:!1,scroll:{y:"calc(100vh - 20rem)",x:"max-content"}})},j=o.memo(S),P=n(2966),N=n(9478),_=n(6871),D=function(){var e,t,n,d,p,v=(0,_.s0)(),g=function(e,t){var n,a=(0,o.useContext)((0,c.K)()),i=(0,b.x)(null===t||void 0===t?void 0:t.client),s=i.defaultOptions.watchQuery;m(e,r.Query);var d,p=(0,o.useState)((function(){var n=y(e,t,s),r=null;return a.renderPromises&&(r=a.renderPromises.getSSRObservable(n)),r||(r=i.watchQuery(n),a.renderPromises&&a.renderPromises.registerSSRObservable(r,n)),a.renderPromises&&!1!==(null===t||void 0===t?void 0:t.ssr)&&!(null===t||void 0===t?void 0:t.skip)&&r.getCurrentResult().loading&&a.renderPromises.addQueryPromise({getOptions:function(){return y(e,t,s)},fetchData:function(){return new Promise((function(e){var t=r.subscribe({next:function(n){n.loading||(e(),t.unsubscribe())},error:function(){e(),t.unsubscribe()},complete:function(){e()}})}))}},(function(){return null})),r})),v=p[0],g=p[1],x=(0,o.useState)((function(){var e,n,r=v.getCurrentResult();return!r.loading&&t&&(r.error?null===(e=t.onError)||void 0===e||e.call(t,r.error):r.data&&(null===(n=t.onCompleted)||void 0===n||n.call(t,r.data))),r})),w=x[0],C=x[1],k=(0,o.useRef)({client:i,query:e,options:t,result:w,previousData:void 0,watchQueryOptions:y(e,t,s)});(0,o.useEffect)((function(){var n,r,o,a=y(e,t,s);if(k.current.client===i&&(0,u.D)(k.current.query,e))(0,u.D)(k.current.watchQueryOptions,a)||(v.setOptions(a).catch((function(){})),o=v.getCurrentResult(),k.current.watchQueryOptions=a);else{var l=i.watchQuery(a);g(l),o=l.getCurrentResult()}if(o){var d=k.current.result;d.data&&(k.current.previousData=d.data),C(k.current.result=o),!o.loading&&t&&(o.error?null===(n=t.onError)||void 0===n||n.call(t,o.error):o.data&&(null===(r=t.onCompleted)||void 0===r||r.call(t,o.data)))}Object.assign(k.current,{client:i,query:e})}),[v,i,e,t]),(0,o.useEffect)((function(){if(!a.renderPromises){var e=v.subscribe(t,(function n(r){var o,a,i=v.last;e.unsubscribe();try{v.resetLastResults(),e=v.subscribe(t,n)}finally{v.last=i}if(!r.hasOwnProperty("graphQLErrors"))throw r;var s=k.current.result;(s&&s.loading||!(0,u.D)(r,s.error))&&(C(k.current.result={data:s.data,error:r,loading:!1,networkStatus:h.I.error}),null===(a=null===(o=k.current.options)||void 0===o?void 0:o.onError)||void 0===a||a.call(o,r))}));return function(){return e.unsubscribe()}}function t(){var e,t,n=k.current.result,r=v.getCurrentResult();n&&n.loading===r.loading&&n.networkStatus===r.networkStatus&&(0,u.D)(n.data,r.data)||(n.data&&(k.current.previousData=n.data),C(k.current.result=r),r.loading||null===(t=null===(e=k.current.options)||void 0===e?void 0:e.onCompleted)||void 0===t||t.call(e,r.data))}}),[v,a.renderPromises,i.disableNetworkFetches]),d=(n=w).partial,w=(0,l._T)(n,["partial"]),!d||!(null===t||void 0===t?void 0:t.partialRefetch)||w.loading||w.data&&0!==Object.keys(w.data).length||"cache-only"===v.options.fetchPolicy||(w=(0,l.pi)((0,l.pi)({},w),{loading:!0,networkStatus:h.I.refetch}),v.refetch()),a.renderPromises&&!1!==(null===t||void 0===t?void 0:t.ssr)&&!(null===t||void 0===t?void 0:t.skip)&&w.loading&&v.setOptions(y(e,t,s)).catch((function(){})),Object.assign(k.current,{options:t}),(a.renderPromises||i.disableNetworkFetches)&&!1===(null===t||void 0===t?void 0:t.ssr)?w=k.current.result={loading:!0,data:void 0,error:void 0,networkStatus:h.I.loading}:((null===t||void 0===t?void 0:t.skip)||"standby"===(null===t||void 0===t?void 0:t.fetchPolicy))&&(w={loading:!1,data:void 0,error:void 0,networkStatus:h.I.ready}),w.errors&&w.errors.length&&(w=(0,l.pi)((0,l.pi)({},w),{error:w.error||new f.c({graphQLErrors:w.errors})}));var R=(0,o.useMemo)((function(){return{refetch:v.refetch.bind(v),fetchMore:v.fetchMore.bind(v),updateQuery:v.updateQuery.bind(v),startPolling:v.startPolling.bind(v),stopPolling:v.stopPolling.bind(v),subscribeToMore:v.subscribeToMore.bind(v)}}),[v]);return(0,l.pi)((0,l.pi)((0,l.pi)({},R),{variables:y(e,t,s).variables,client:i,called:!0,previousData:k.current.previousData}),w)}(N.pD,{variables:{first:10,offset:0},notifyOnNetworkStatusChange:!0}),x=g.loading,w=g.error,R=g.data,S=g.refetch;if(w)return console.error(w),(0,k.jsx)("p",{children:"Oops, something went wrong ~"});var D=(0,C.DF)((null===R||void 0===R||null===(e=R.crowdloanWhoStatistics)||void 0===e?void 0:e.nodes)||[]),O=D.csvRows,T=D.rewardsTableDataSource,I=D.totalCurrentCRab,E=D.totalCurrentCKton,Q=D.totalStageCRab,F=D.totalStageCKTON;return(0,k.jsxs)(P.Xg,{children:[(0,k.jsxs)(P.JH,{children:[(0,k.jsxs)("div",{className:"flex items-end justify-end space-x-24 mb-2",children:[(0,k.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,k.jsx)(a.Z,{loading:x,title:"Total Current CRAB",value:I.toFixed(8)}),(0,k.jsx)(a.Z,{loading:x,title:"Total Current CKTON",value:E.toFixed(8)}),(0,k.jsx)(a.Z,{loading:x,title:"Total Stage CRAB",value:Q.toFixed(8)}),(0,k.jsx)(a.Z,{loading:x,title:"Total Stage CKTON",value:F.toFixed(8)})]}),(0,k.jsxs)("div",{className:"flex justify-end items-end space-x-2",children:[(0,k.jsxs)(i.Z,{className:"rounded-md",onClick:function(){S({first:0,offset:0})},disabled:!1===(null===R||void 0===R||null===(t=R.crowdloanWhoStatistics)||void 0===t||null===(n=t.pageInfo)||void 0===n?void 0:n.hasNextPage),loading:x,type:"primary",children:["Fetch All (",(null===R||void 0===R||null===(d=R.crowdloanWhoStatistics)||void 0===d?void 0:d.nodes.length)||0,"/",(null===R||void 0===R||null===(p=R.crowdloanWhoStatistics)||void 0===p?void 0:p.totalCount)||0,")"]}),(0,k.jsx)(i.Z,{className:"rounded-md",onClick:function(){(0,C.ns)(O.map((function(e){return e.join(",")})).join("\n"))},disabled:0===O.length,loading:x,children:"Download CSV"})]})]}),(0,k.jsxs)(s.Z,{className:"pl-px pb-1",children:[(0,k.jsx)(s.Z.Item,{className:"antd-breadcrumb-item",onClick:function(){return v("/")},children:"Home"}),(0,k.jsx)(s.Z.Item,{children:"Rewards"})]}),(0,k.jsx)(j,{loading:x,dataSource:T})]}),(0,k.jsx)(P.WA,{})]})},O=o.memo(D)},7253:function(e,t,n){"use strict";n.d(t,{sC:function(){return u},ns:function(){return d},DF:function(){return c},hx:function(){return f}});var r=n(1413),o=n(7762),a=n(5395),i=n.n(a),s=n(4350),l=n(9478),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.length&&e.length>12?"".concat(e.slice(0,5),"...").concat(e.slice(e.length-5)):e},d=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"transferx.csv",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"data:text/csv;charset=utf-8",r=new Blob(["\ufeff"+e],{type:n}),o=URL.createObjectURL(r),a=document.createElement("a");a.style.display="none",a.href=o,a.download=t,document.body.appendChild(a),a.click(),setTimeout((function(){document.body.removeChild(a),window.URL.revokeObjectURL(o)}),0)},c=function(e){var t=i()(0),n=i()(0),r=i()(0),o=i()(0),a=[],s=[];return null===e||void 0===e||e.forEach((function(u,d){var c=u.contributors.nodes.reduce((function(e,t){return i()(e).add(t.powerRefer).toString()}),"0"),f=i()(u.totalPower).add(c).div(l.cU),h=f.times(l.j9),p=f.times(l.bN),v=h.times(.1),g=p.times(.1);t=t.add(h),n=n.add(p),r=r.add(v),o=o.add(g),a.push([u.user,"ring",v.toFixed(8),"kusama"]),a.push([u.user,"kton",g.toFixed(8),"kusama"]),s.push({key:d,index:(null===e||void 0===e?void 0:e.length)-d,address:u.user,currentCRabRewards:h.toFixed(8),stageCRabRewards:v.toFixed(8),currentCKtonRewards:p.toFixed(8),stageCKtonRewards:g.toFixed(8)})})),{csvRows:a,rewardsTableDataSource:s,totalCurrentCRab:t,totalCurrentCKton:n,totalStageCRab:r,totalStageCKTON:o}},f=function(e,t){var n,a=[],u=[],d=(0,o.Z)(e);try{var c=function(){var e=n.value,r=null===t||void 0===t?void 0:t.find((function(t){return t.signer===e[0]}));u.push({key:0,index:0,address:e[0],ksmContribute:i()(e[1]).div(l.UM).toFixed(8),claimAddress:r?{address:r.addressValue,extrinsicHash:r.extrinsicHash}:null,isClaimed:!!r}),r&&s.UJ(r.addressValue)&&a.push(r.addressValue)};for(d.s();!(n=d.n()).done;)c()}catch(f){d.e(f)}finally{d.f()}return u=u.map((function(e,t){return(0,r.Z)((0,r.Z)({},e),{},{key:t,index:u.length-t})})),{csvRows:a,nftTableDataSource:u}}},6601:function(){}}]);
//# sourceMappingURL=845.d37378e4.chunk.js.map